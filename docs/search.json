[
  {
    "objectID": "HW8_DKorver.html",
    "href": "HW8_DKorver.html",
    "title": "ST558 Homework 8",
    "section": "",
    "text": "library(tidyverse)\nlibrary(janitor)\nlibrary(tidymodels)\nlibrary(GGally)\nbike_data &lt;- read_csv(\"https://www4.stat.ncsu.edu/online/datasets/SeoulBikeData.csv\",locale = locale(encoding = \"ISO-8859-1\"))\nbike_data &lt;- bike_data %&gt;% janitor::clean_names()\n#format the date variable to be an actual date variable\nbike_data$date_new&lt;-as.Date(bike_data$date,format=\"%m/%d/%y\")\n#convert character variables to factor\nbike_data &lt;- bike_data %&gt;% mutate(across(where(is.character), as.factor))\nbike_data_numVars &lt;- \n  bike_data %&gt;%\n  filter(functioning_day==\"Yes\") %&gt;%\n  select(-date,-seasons,-holiday,-functioning_day,-date_new) \n\nNo missing data.\n\nsum_na &lt;- function(column){\n  sum(is.na(column))\n}\n\nna_counts &lt;- bike_data |&gt;\n  summarize(across(everything(), sum_na))\nsummary(na_counts)\n\n      date   rented_bike_count      hour   temperature_c humidity_percent\n Min.   :0   Min.   :0         Min.   :0   Min.   :0     Min.   :0       \n 1st Qu.:0   1st Qu.:0         1st Qu.:0   1st Qu.:0     1st Qu.:0       \n Median :0   Median :0         Median :0   Median :0     Median :0       \n Mean   :0   Mean   :0         Mean   :0   Mean   :0     Mean   :0       \n 3rd Qu.:0   3rd Qu.:0         3rd Qu.:0   3rd Qu.:0     3rd Qu.:0       \n Max.   :0   Max.   :0         Max.   :0   Max.   :0     Max.   :0       \n wind_speed_m_s visibility_10m dew_point_temperature_c solar_radiation_mj_m2\n Min.   :0      Min.   :0      Min.   :0               Min.   :0            \n 1st Qu.:0      1st Qu.:0      1st Qu.:0               1st Qu.:0            \n Median :0      Median :0      Median :0               Median :0            \n Mean   :0      Mean   :0      Mean   :0               Mean   :0            \n 3rd Qu.:0      3rd Qu.:0      3rd Qu.:0               3rd Qu.:0            \n Max.   :0      Max.   :0      Max.   :0               Max.   :0            \n  rainfall_mm  snowfall_cm    seasons     holiday  functioning_day\n Min.   :0    Min.   :0    Min.   :0   Min.   :0   Min.   :0      \n 1st Qu.:0    1st Qu.:0    1st Qu.:0   1st Qu.:0   1st Qu.:0      \n Median :0    Median :0    Median :0   Median :0   Median :0      \n Mean   :0    Mean   :0    Mean   :0   Mean   :0   Mean   :0      \n 3rd Qu.:0    3rd Qu.:0    3rd Qu.:0   3rd Qu.:0   3rd Qu.:0      \n Max.   :0    Max.   :0    Max.   :0   Max.   :0   Max.   :0      \n    date_new   \n Min.   :5304  \n 1st Qu.:5304  \n Median :5304  \n Mean   :5304  \n 3rd Qu.:5304  \n Max.   :5304  \n\n\nBasic stats and correlations.\n\nsummary(bike_data)\n\n         date      rented_bike_count      hour       temperature_c   \n 01/01/2018:  24   Min.   :   0.0    Min.   : 0.00   Min.   :-17.80  \n 01/02/2018:  24   1st Qu.: 191.0    1st Qu.: 5.75   1st Qu.:  3.50  \n 01/03/2018:  24   Median : 504.5    Median :11.50   Median : 13.70  \n 01/04/2018:  24   Mean   : 704.6    Mean   :11.50   Mean   : 12.88  \n 01/05/2018:  24   3rd Qu.:1065.2    3rd Qu.:17.25   3rd Qu.: 22.50  \n 01/06/2018:  24   Max.   :3556.0    Max.   :23.00   Max.   : 39.40  \n (Other)   :8616                                                     \n humidity_percent wind_speed_m_s  visibility_10m dew_point_temperature_c\n Min.   : 0.00    Min.   :0.000   Min.   :  27   Min.   :-30.600        \n 1st Qu.:42.00    1st Qu.:0.900   1st Qu.: 940   1st Qu.: -4.700        \n Median :57.00    Median :1.500   Median :1698   Median :  5.100        \n Mean   :58.23    Mean   :1.725   Mean   :1437   Mean   :  4.074        \n 3rd Qu.:74.00    3rd Qu.:2.300   3rd Qu.:2000   3rd Qu.: 14.800        \n Max.   :98.00    Max.   :7.400   Max.   :2000   Max.   : 27.200        \n                                                                        \n solar_radiation_mj_m2  rainfall_mm       snowfall_cm        seasons    \n Min.   :0.0000        Min.   : 0.0000   Min.   :0.00000   Autumn:2184  \n 1st Qu.:0.0000        1st Qu.: 0.0000   1st Qu.:0.00000   Spring:2208  \n Median :0.0100        Median : 0.0000   Median :0.00000   Summer:2208  \n Mean   :0.5691        Mean   : 0.1487   Mean   :0.07507   Winter:2160  \n 3rd Qu.:0.9300        3rd Qu.: 0.0000   3rd Qu.:0.00000                \n Max.   :3.5200        Max.   :35.0000   Max.   :8.80000                \n                                                                        \n       holiday     functioning_day    date_new         \n Holiday   : 432   No : 295        Min.   :2020-01-01  \n No Holiday:8328   Yes:8465        1st Qu.:2020-03-27  \n                                   Median :2020-06-21  \n                                   Mean   :2020-06-21  \n                                   3rd Qu.:2020-09-16  \n                                   Max.   :2020-12-12  \n                                   NA's   :5304        \n\nsummary(bike_data$rented_bike_count)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n    0.0   191.0   504.5   704.6  1065.2  3556.0 \n\ntable(bike_data$seasons)\n\n\nAutumn Spring Summer Winter \n  2184   2208   2208   2160 \n\ntable(bike_data$holiday)\n\n\n   Holiday No Holiday \n       432       8328 \n\ntable(bike_data$functioning_day)\n\n\n  No  Yes \n 295 8465 \n\ncor(bike_data_numVars)\n\n                        rented_bike_count         hour temperature_c\nrented_bike_count               1.0000000  0.425255882    0.56274017\nhour                            0.4252559  1.000000000    0.12274182\ntemperature_c                   0.5627402  0.122741816    1.00000000\nhumidity_percent               -0.2019727 -0.235937180    0.16642522\nwind_speed_m_s                  0.1250219  0.287779819   -0.03848085\nvisibility_10m                  0.2123228  0.103869318    0.02826206\ndew_point_temperature_c         0.4002628  0.004691479    0.91446695\nsolar_radiation_mj_m2           0.2738616  0.144658482    0.35484355\nrainfall_mm                    -0.1286261  0.014344645    0.05214889\nsnowfall_cm                    -0.1516108 -0.022082499   -0.21774581\n                        humidity_percent wind_speed_m_s visibility_10m\nrented_bike_count             -0.2019727    0.125021946     0.21232278\nhour                          -0.2359372    0.287779819     0.10386932\ntemperature_c                  0.1664252   -0.038480848     0.02826206\nhumidity_percent               1.0000000   -0.337352380    -0.54854183\nwind_speed_m_s                -0.3373524    1.000000000     0.18042765\nvisibility_10m                -0.5485418    0.180427649     1.00000000\ndew_point_temperature_c        0.5394024   -0.177170126    -0.18258645\nsolar_radiation_mj_m2         -0.4572727    0.326221868     0.15304614\nrainfall_mm                    0.2369169   -0.024931327    -0.17035180\nsnowfall_cm                    0.1101265   -0.003789344    -0.12285973\n                        dew_point_temperature_c solar_radiation_mj_m2\nrented_bike_count                   0.400262829            0.27386155\nhour                                0.004691479            0.14465848\ntemperature_c                       0.914466952            0.35484355\nhumidity_percent                    0.539402446           -0.45727269\nwind_speed_m_s                     -0.177170126            0.32622187\nvisibility_10m                     -0.182586445            0.15304614\ndew_point_temperature_c             1.000000000            0.09852498\nsolar_radiation_mj_m2               0.098524979            1.00000000\nrainfall_mm                         0.126812453           -0.07415727\nsnowfall_cm                        -0.149759793           -0.07337987\n                         rainfall_mm  snowfall_cm\nrented_bike_count       -0.128626093 -0.151610753\nhour                     0.014344645 -0.022082499\ntemperature_c            0.052148891 -0.217745811\nhumidity_percent         0.236916912  0.110126502\nwind_speed_m_s          -0.024931327 -0.003789344\nvisibility_10m          -0.170351798 -0.122859731\ndew_point_temperature_c  0.126812453 -0.149759793\nsolar_radiation_mj_m2   -0.074157271 -0.073379874\nrainfall_mm              1.000000000  0.008604092\nsnowfall_cm              0.008604092  1.000000000\n\n\nAggregate and create a training and test dataset.\n\nbike_data_for_model &lt;- bike_data %&gt;%\n  group_by(date_new,seasons,holiday) %&gt;%\n  filter(functioning_day==\"Yes\") %&gt;%\n  summarize(bike_count = sum(rented_bike_count),\n            temp = mean(temperature_c),\n            humidity = mean(humidity_percent),\n            wind_speed = mean(wind_speed_m_s),\n            vis = mean(visibility_10m),\n            dew_point_temp = mean(dew_point_temperature_c),\n            solar_radiation = mean(solar_radiation_mj_m2),\n            rainfall = sum(rainfall_mm),\n            snowfall = sum(snowfall_cm)) %&gt;%\n  ungroup()\n\n`summarise()` has grouped output by 'date_new', 'seasons'. You can override\nusing the `.groups` argument.\n\nbike_data_for_model_numVars &lt;- bike_data_for_model %&gt;%\n  select(-seasons,-holiday,-date_new) \n\nset.seed(123)\nbike_split &lt;- initial_split(bike_data, prop = 0.75, strata = seasons)\nbike_train &lt;- training(bike_split)\nbike_test &lt;- testing(bike_split)\nbike_10_fold &lt;- vfold_cv(bike_train, 10)"
  }
]